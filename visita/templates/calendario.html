{% extends "baseBackend.html" %} 
{% block titulo %} Visitas Agendadas {% endblock %} 
{% block extrahead %}

<!--FullCalendar-->
<link href="{% static 'plugins/fullcalendar/packages/core/main.css'%}" rel='stylesheet' />
<link href="{% static 'plugins/fullcalendar/packages/daygrid/main.css'%}" rel='stylesheet' />
<link href="{% static 'plugins/fullcalendar/packages/bootstrap/main.css'%}" rel='stylesheet' />



{% endblock %} {% block content %}

<div id='calendar' style="margin-top: 20px;"></div>


{% endblock %} 
{% block plugins %}

<!-- Full Calendar -->
<script src="{% static 'plugins/fullcalendar/packages/core/main.js'%}"></script>
<script src="{% static 'plugins/fullcalendar/packages/daygrid/main.js'%}"></script>
<script src="{% static 'plugins/fullcalendar/packages/bootstrap/main.js'%}"></script>


<script>

let eventos = []

const loadCalendar = () => axios.get("{% url 'visita:visitasAgendadas' %}")
    .then(function (response) {
        // handle success
        const visitas = response.data.lista
        //console.log(visitas)
        //console.log(typeof(visitas))
        for (index in visitas) {
            eventos.push({
                    title: visitas[index].nombre,
                    start: visitas[index].fecha
                })
        }
        /* initialize the calendar
        -----------------------------------------------------------------*/
        const date = new Date();
        const d = date.getDate();
        const m = date.getMonth();
        const y = date.getFullYear();


        const calendarEl = document.getElementById('calendar');
        const calendar = new FullCalendar.Calendar(calendarEl, {
            plugins: [ 'dayGrid','bootstrap' ],
            timeZone: 'UTC',
            themeSystem: 'bootstrap',
            header: {
                left: 'prev,next',
                center: 'title',
                right: 'month,agendaWeek,agendaDay'
            },
            editable: false,
            events: eventos
        });

        calendar.setOption('locale', 'es')

        calendar.render();
    })
    .catch(function (error) {
        // handle error
        console.log(error);
    })

        
loadCalendar()
</script>   

{% endblock %} 
